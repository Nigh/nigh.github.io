---
title: å…‰å­¦è„‰ææµ‹é‡
date: 2016-05-10 12:00:00 +0800
tags:
    - âš™
    - ðŸ’»
    - arduino
    - love2d
summary: ä½¿ç”¨ arduino + PulseSensor æµ‹é‡è„‰æ
---

## demoå±•ç¤º

![](http://cdn.corumi.cn/pulsesensor/IMG_1_2.jpg-h720p)

## ææ–™å‡†å¤‡

### ç¡¬ä»¶

+ windowså¹³å°ä¸€ä¸ª(winXP+)
+ arduinoå¼€å‘æ¿ä¸€å—
	* è‡³å°‘æœ‰ä¸€è·¯ADC
	* è‡³å°‘æœ‰ä¸€è·¯ä¸²å£
+ PulseSensorä¸€ä¸ª
	* æŸå®ä¸Šå¾ˆå¤šï¼Œä»·æ ¼åœ¨åå‡ å—åˆ°äºŒåå‡ å—ä¸ç­‰
+ å¥åº·äººç±»ä¸€åª

ç¬”è€…çš„æ¼”ç¤ºçŽ¯å¢ƒå¦‚ä¸‹ï¼š

+ Arduino Leonardo
+ SP4(Windows10 10586.218)

![](http://cdn.corumi.cn/pulsesensor/IMG_3_2.jpg-h720p)

### è½¯ä»¶

+ [luaçŽ¯å¢ƒ](http://files.luaforge.net/releases/luaforwindows/luaforwindows)
	* å®‰è£…5.1ç‰ˆæœ¬
+ [love2d](https://love2d.org/)
	* è¯·å®‰è£…32ä½ç‰ˆæœ¬
+ [arduino IDE](https://www.arduino.cc/en/Main/Software)
	* æœ€æ–°ç‰ˆæœ¬å³å¯

## ä¸‹ä½æœº

### å™¨ä»¶è¿žæŽ¥

ä¼ æ„Ÿå™¨å¼•è„šä»Žå·¦å¾€å³åˆ†åˆ«æ˜¯`GND`,`VCC`å’Œ`SIG`ï¼Œåˆ†åˆ«è¿žæŽ¥è‡³`åœ°`ï¼Œ`ç”µæº`å’Œ`ADC`å£å³å¯ã€‚ä¼ æ„Ÿå™¨å…¼å®¹3.3v-5vçš„é©±åŠ¨ç”µåŽ‹ã€‚
![è¿žæŽ¥å›¾](http://cdn.corumi.cn/pulsesensor/IMG_4_2.jpg-h720p)

### ä»£ç 

ç”±äºŽä¸‹ä½æœºä»£ç å¤ªçŸ­ï¼Œæˆ‘å°±ç›´æŽ¥è´´åœ¨è¿™é‡Œäº†ã€‚

	void setup(void)
	{
		Serial.begin(115200);
	}
	void loop(void)
	{
		Serial.print("x:");
		Serial.print(analogRead(A0));
		Serial.print(",\n");
		delay(20);
	}

åŠŸèƒ½å°±æ˜¯æŒ‰ç…§ä¸€å®šçš„é¢‘çŽ‡æŠŠ`A0`å£çš„ADå€¼ä»¥`x:{value},\n`çš„æ ¼å¼é€šè¿‡ä¸²å£å‘é€è‡³ä¸Šä½æœºã€‚

## ä¸Šä½æœº

ä¸Šä½æœºä¸Šä½¿ç”¨äº†ä¸€æ¬¾å°å·§çš„è·¨å¹³å°å¼€æºå›¾å½¢å¼•æ“Ž`love2d`æ¥ç»˜åˆ¶ç•Œé¢ã€‚
ä½ å¯ä»¥å¾ˆå®¹æ˜“çš„æŠŠåœ¨ä¸Šé¢å¼€å‘çš„ç¨‹åºç§»æ¤åˆ°å…¶ä»–å¹³å°ã€‚


ç”±äºŽ`love2d`å¼•æ“Žä½¿ç”¨luaå¼€å‘ï¼Œç¬”è€…ä½¿ç”¨äº†ä¸€ä¸ª[luars232](https://github.com/LuaDist2/luars232/releases)åº“æ¥å®Œæˆä¸²å£é€šä¿¡ã€‚

>ç»è¿‡ç¬”è€…æµ‹è¯•ï¼Œè¿™ä¸ªluars232åº“æœ‰è¿™æ ·çš„bugï¼Œæ— æ³•æ‰“å¼€å¤§äºŽCOM9çš„ä¸²å£ã€‚æ‰€ä»¥å¦‚æžœä½ çš„è®¾å¤‡è¿žæŽ¥ä¸Šä¹‹åŽå¦‚æžœä¸²å£å·è¶…è¿‡äº†COM9ï¼Œè¯·æ‰‹åŠ¨æ”¹è‡³COM0-9çš„èŒƒå›´ã€‚

ä¸Šä½æœºç»è¿‡å¦‚ä¸‹æ­¥éª¤ä¾¿å¯å¾—åˆ°é¢˜å›¾æ‰€ç¤ºçš„æ•ˆæžœï¼š

1. ä¸‹è½½å¹¶å®‰è£…love2då¼•æ“Ž(32bits)
2. ä¸‹è½½å¹¶å®‰è£…lua for windowsçŽ¯å¢ƒ
3. ä½¿ç”¨luaä¸­çš„`lua51.dll`æ›¿æ¢love2dä¸­çš„dll
4. git clone æˆ‘çš„demoé¡¹ç›®
5. å°†ä½ çš„å¼€å‘æ¿è¿žæŽ¥è‡³ç”µè„‘ï¼Œå¹¶è°ƒæ•´COMå£ç¼–å·è‡³åˆé€‚èŒƒå›´
6. ç¼–è¾‘`\gui-love2d\main.lua`æ–‡ä»¶ï¼Œå°†å¤´éƒ¨`rs232.open()`ä¸­çš„COMå£æ”¹æˆä½ æ‰€ä½¿ç”¨çš„
7. å°†`\gui-love2d\`ç›®å½•ä¸‹çš„æ–‡ä»¶æ‰“åŒ…æˆ`zip`(ä¸è¦æ‰“åŒ…ç›®å½•)ï¼Œå¹¶æ›´æ”¹åŽç¼€ä¸º`.love`
8. åŒå‡»è¿è¡Œå¾—åˆ°çš„`.love`æ–‡ä»¶å³å¯

ä½ å¯ä»¥å…ˆç”¨arduino IDEè‡ªå¸¦çš„ä¸²å£å·¥å…·æŸ¥çœ‹ä¸€ä¸‹å¼€å‘æ¿çš„ä¸²å£è¾“å‡ºæ˜¯å¦æ­£å¸¸å†è¿›è¡Œä¸‹ä¸€æ­¥
![](http://cdn.corumi.cn/pulsesensor/serial2.png-h720p)

æœ€ç»ˆï¼Œåº”è¯¥å¾—åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ç»“æžœã€‚
![](http://cdn.corumi.cn/pulsesensor/window2.png-h720p)



>ps. ç¬¬7ç‚¹æ‰€è¿°ä¸ºlove2dçš„æ‰“åŒ…æ–¹æ³•ä¹‹ä¸€ï¼Œæ›´å¤šè¿è¡Œæ–¹æ³•è¯·å‚è§å®˜ç½‘  
>ps.. ç¬¬3ç‚¹æ˜¯å› ä¸ºlove2dä½¿ç”¨äº†luajitï¼Œæ— æ³•æ­£å¸¸è°ƒç”¨luars232ï¼Œæ›¿æ¢æˆåŽŸç”Ÿluaå³å¯  



>æœ¬é¡¹ç›®Git:[https://github.com/Nigh/pulsesensor-demo]

---
import Profile from '../components/profilepic.astro';
import Brief from '../components/brief.astro';
import Skills from '../components/skill.astro';
import Contact from '../components/contact.astro';

const base = import.meta.env.PUBLIC_BASE_URL;
---

<div
  id="hero-section"
  class="relative flex flex-col md:flex-row gap-4 justify-center items-stretch w-full h-screen"
>
  <div class="relative flex-1 w-full h-full">
    <div
      id="scroll-indicator-top"
      class="absolute top-4 left-1/2 -translate-x-1/2 z-20 transition-opacity duration-300 opacity-0 pointer-events-none text-primary"
    >
      <div class="animate-bounce p-2">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="4"
          stroke="currentColor"
          class="w-6 h-6"
        >
          <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5"></path>
        </svg>
      </div>
    </div>

    <div id="hero-scroll" class="hero-scroll px-4">
      <section data-hero-panel class="min-h-screen">
        <Brief />
      </section>
      <section data-hero-panel class="min-h-screen">
        <Skills />
      </section>
      <section data-hero-panel class="min-h-screen flex flex-col justify-center">
        <Contact />
      </section>
    </div>

    <div
      id="scroll-indicator-bottom"
      class="absolute bottom-4 left-1/2 -translate-x-1/2 z-20 transition-opacity duration-300 pointer-events-none text-primary"
    >
      <div class="animate-bounce p-2">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="4"
          stroke="currentColor"
          class="w-6 h-6"
        >
          <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"></path>
        </svg>
      </div>
    </div>
  </div>

  <div class="hidden md:block" style="view-transition-name:profile;">
    <div class="tooltip tooltip-primary">
      <div class="tooltip-content">
        <div class="animate-bounce text-primary-content -rotate-3 text-2xl font-black">
          Click for more!!!
        </div>
      </div>
      <a href={base + 'about/'}>
        <Profile />
      </a>
    </div>
  </div>
</div>

<script>
  const heroScroll = document.getElementById('hero-scroll');
  const topIndicator = document.getElementById('scroll-indicator-top');
  const bottomIndicator = document.getElementById('scroll-indicator-bottom');

  const updateIndicators = () => {
    if (!heroScroll) return;

    const { scrollTop, scrollHeight, clientHeight } = heroScroll;
    const isScrollable = scrollHeight > clientHeight + 1;
    const isAtTop = !isScrollable || scrollTop <= 10;
    const isAtBottom = !isScrollable || Math.ceil(scrollTop + clientHeight) >= scrollHeight - 1;

    if (topIndicator) topIndicator.classList.toggle('opacity-0', isAtTop);
    if (bottomIndicator) bottomIndicator.classList.toggle('opacity-0', isAtBottom);
  };

  heroScroll?.addEventListener('scroll', updateIndicators, { passive: true });
  window.addEventListener('resize', updateIndicators);
  updateIndicators();
</script>
